<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŠ¨ç‰©å®¶åº­è¿è¿çœ‹</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a5f7a, #159895);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            color: #fff;
        }
        
        .container {
            max-width: 1200px;
            width: 100%;
            text-align: center;
        }
        
        header {
            margin-bottom: 25px;
            text-align: center;
        }
        
        h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            color: #ffd166;
            background: linear-gradient(to right, #ffd166, #ff9e00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #e0f7fa;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .game-info {
            display: flex;
            justify-content: space-between;
            background: rgba(255, 255, 255, 0.15);
            padding: 15px 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
        }
        
        .info-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .info-label {
            font-size: 0.9rem;
            margin-bottom: 5px;
            color: #b2ebf2;
        }
        
        .info-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #ffd166;
        }
        
        .game-area {
            display: flex;
            gap: 25px;
            margin-bottom: 25px;
        }
        
        .game-board {
            flex: 2;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(5px);
        }
        
        .animal-info {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            backdrop-filter: blur(5px);
            min-height: 500px;
        }
        
        .animal-family-img {
            width: 100%;
            height: 200px;
            border-radius: 10px;
            margin-bottom: 20px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            background: #0a4a5f;
        }
        
        .animal-family-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .animal-knowledge {
            text-align: left;
            font-size: 1rem;
            line-height: 1.6;
            color: #e0f7fa;
            margin-top: 15px;
        }
        
        .animal-name {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ffd166;
            margin-bottom: 10px;
        }
        
        .card {
            aspect-ratio: 1/1;
            background: linear-gradient(145deg, #0a4a5f, #0d7a8c);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        
        .card:hover {
            transform: translateY(-5px) scale(1.03);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.4);
        }
        
        .card.selected {
            transform: scale(0.95);
            box-shadow: 0 0 0 3px #ffd166, 0 0 15px #ffd166;
        }
        
        .card.matched {
            visibility: hidden;
            opacity: 0;
            transform: scale(0);
        }
        
        .card-content {
            width: 85%;
            height: 85%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            text-align: center;
            border-radius: 8px;
            overflow: hidden;
            background: #0a4a5f;
            position: relative;
        }
        
        .animal-image {
            width: 100%;
            height: 70%;
            object-fit: cover;
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
        }
        
        .animal-label {
            height: 30%;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            font-size: 0.85rem;
            padding: 5px;
            background: rgba(0, 0, 0, 0.5);
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 25px;
        }
        
        button {
            padding: 14px 30px;
            border: none;
            border-radius: 50px;
            background: linear-gradient(to right, #ffd166, #ff9e00);
            color: #0a4a5f;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1rem;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        
        button:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .connection-line {
            position: absolute;
            background: linear-gradient(to right, #ffd166, #ff9e00);
            z-index: 10;
            pointer-events: none;
            border-radius: 2px;
            box-shadow: 0 0 8px #ffd166;
        }
        
        .message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            color: #0a4a5f;
            padding: 25px 50px;
            border-radius: 15px;
            font-size: 1.5rem;
            font-weight: bold;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
            z-index: 100;
            display: none;
            text-align: center;
            border-left: 5px solid #ffd166;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            margin-top: 10px;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(to right, #4cd964, #5ac8fa);
            width: 100%;
            transition: width 1s linear;
        }
        
        @media (max-width: 1100px) {
            .game-area {
                flex-direction: column;
            }
            
            .game-board {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .game-board {
                grid-template-columns: repeat(3, 1fr);
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            button {
                width: 80%;
            }
        }
        
        @media (max-width: 480px) {
            .game-board {
                grid-template-columns: repeat(2, 1fr);
            }
            
            h1 {
                font-size: 1.8rem;
            }
        }
        
        .game-rules {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 15px;
            text-align: left;
            font-size: 0.9rem;
            min-height: 500px;
        }
        
        .game-rules h3 {
            color: #ffd166;
            margin-bottom: 10px;
        }
        
        .game-rules ul {
            padding-left: 20px;
        }
        
        .game-rules li {
            margin-bottom: 8px;
            line-height: 1.4;
        }
        
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            font-size: 1.2rem;
            color: #ffd166;
        }
        
        .fallback-icon {
            font-size: 3rem;
            color: #ffd166;
        }
        
        .image-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #0a4a5f;
            color: #ffd166;
            font-size: 2rem;
        }
        
        .image-placeholder span {
            font-size: 0.8rem;
            margin-top: 10px;
            color: #e0f7fa;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-paw"></i> åŠ¨ç‰©å®¶åº­è¿è¿çœ‹</h1>
            <p class="subtitle">è¿æ¥åŠ¨ç‰©çš„æˆå¹´ä¸å¹¼å¹´å½¢æ€ï¼Œæ¢ç´¢æœ‰è¶£çš„åŠ¨ç‰©å®¶åº­çŸ¥è¯†ï¼</p>
        </header>
        
        <div class="game-info">
            <div class="info-item">
                <div class="info-label"><i class="far fa-clock"></i> å‰©ä½™æ—¶é—´</div>
                <div class="info-value" id="timer">120</div>
                <div class="progress-bar">
                    <div class="progress" id="timeProgress"></div>
                </div>
            </div>
            <div class="info-item">
                <div class="info-label"><i class="fas fa-check-circle"></i> å·²åŒ¹é…</div>
                <div class="info-value" id="matched">0/6</div>
            </div>
            <div class="info-item">
                <div class="info-label"><i class="fas fa-star"></i> å¾—åˆ†</div>
                <div class="info-value" id="score">0</div>
            </div>
        </div>
        
        <div class="game-area">
            <div class="game-board" id="gameBoard">
                <div class="loading">æ­£åœ¨åŠ è½½å›¾ç‰‡ï¼Œè¯·ç¨å€™...</div>
            </div>
            <div class="game-rules">
                <h3><i class="fas fa-info-circle"></i> æ¸¸æˆè§„åˆ™</h3>
                <ul>
                    <li>ç‚¹å‡»ä¸¤å¼ å¡ç‰‡å°è¯•åŒ¹é…æˆå¹´å’Œå¹¼å¹´åŠ¨ç‰©</li>
                    <li>åŒ¹é…æˆåŠŸå¾—100åˆ†ï¼Œå¤±è´¥æ‰£10åˆ†</li>
                    <li>ä½¿ç”¨æç¤ºåŠŸèƒ½ä¼šæ‰£é™¤20åˆ†</li>
                    <li>åœ¨æ—¶é—´ç»“æŸå‰åŒ¹é…æ‰€æœ‰åŠ¨ç‰©è·èƒœ</li>
                </ul>
            </div>
        </div>
        
        <div class="controls">
            <button id="startBtn"><i class="fas fa-play"></i> å¼€å§‹æ¸¸æˆ</button>
            <button id="resetBtn"><i class="fas fa-redo"></i> é‡æ–°å¼€å§‹</button>
            <button id="hintBtn"><i class="fas fa-lightbulb"></i> æç¤º</button>
        </div>
    </div>
    
    <div class="message" id="message"></div>

    <script>
        // åŠ¨ç‰©æ•°æ® - æˆå¹´å’Œå¹¼å¹´é…å¯¹
        const animalPairs = [
    { 
        name: "å¤§è±¡",
        adult: "https://images.pexels.com/photos/16023/elephant-animal-wildlife-africa.jpg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1", 
        baby: "https://images.pexels.com/photos/133394/elephant-animal-mammal-wildlife.jpg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1", 
        familyImg: "https://images.pexels.com/photos/247388/elephant-animal-wild-mammal.jpg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        knowledge: "å¤§è±¡æ˜¯ç¾¤å±…åŠ¨ç‰©ï¼Œé€šå¸¸ç”±ä¸€å¤´å¹´é•¿çš„é›Œè±¡é¢†å¯¼æ•´ä¸ªå®¶æ—ã€‚å°è±¡ä¼šåœ¨æ¯äº²å’Œå®¶æ—å…¶ä»–æˆå‘˜çš„ç…§é¡¾ä¸‹æˆé•¿ï¼Œå­¦ä¹ ç”Ÿå­˜æŠ€èƒ½ã€‚å¤§è±¡çš„å­•æœŸé•¿è¾¾22ä¸ªæœˆï¼Œæ˜¯é™†åœ°åŠ¨ç‰©ä¸­æœ€é•¿çš„ã€‚",
        fallbackIcon: "ğŸ˜"
    },
    { 
        name: "ç‹®å­",
        adult: "https://images.pexels.com/photos/33045/lion-simba-grass-savannah.jpg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1", 
        baby: "https://images.pexels.com/photos/247396/lion-cub-lioness-young-animal.jpg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1", 
        familyImg: "https://images.pexels.com/photos/247402/lion-lioness-lions-pride.jpg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        knowledge: "ç‹®å­æ˜¯å”¯ä¸€ç¾¤å±…çš„çŒ«ç§‘åŠ¨ç‰©ï¼Œä¸€ä¸ªç‹®ç¾¤é€šå¸¸ç”±å‡ åªé›Œç‹®ã€å®ƒä»¬çš„å¹¼å´½å’Œå°‘æ•°é›„ç‹®ç»„æˆã€‚å¹¼ç‹®åœ¨ç¾¤ä½“ä¸­å—åˆ°æ‰€æœ‰é›Œç‹®çš„ä¿æŠ¤ï¼Œé›„ç‹®ä¸»è¦è´Ÿè´£ä¿å«é¢†åœ°ã€‚",
        fallbackIcon: "ğŸ¦"
    },
    { 
        name: "è€è™",
        adult: "https://images.pexels.com/photos/247397/tiger-animal-wildlife-zoo.jpg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1", 
        baby: "https://images.pexels.com/photos/247399/tiger-cub-tiger-cubs-cute.jpg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1", 
        familyImg: "https://images.pexels.com/photos/247401/tiger-cub-tiger-cubs-mother.jpg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        knowledge: "è€è™æ˜¯ç‹¬å±…åŠ¨ç‰©ï¼Œé›Œè™ç‹¬è‡ªæŠšå…»å¹¼å´½ã€‚å¹¼è™ä¼šè·Ÿéšæ¯äº²ç”Ÿæ´»2-3å¹´ï¼Œå­¦ä¹ æ•çŒæŠ€å·§ï¼Œä¹‹åä¼šç¦»å¼€å»ºç«‹è‡ªå·±çš„é¢†åœ°ã€‚",
        fallbackIcon: "ğŸ¯"
    },
    { 
        name: "ç†ŠçŒ«",
        adult: "https://images.pexels.com/photos/247403/panda-bear-animal-bamboo.jpg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1", 
        baby: "https://images.pexels.com/photos/247404/panda-bear-cub-baby.jpg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1", 
        familyImg: "https://images.pexels.com/photos/247405/panda-bear-family-mother.jpg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        knowledge: "å¤§ç†ŠçŒ«é€šå¸¸æ˜¯ç‹¬å±…åŠ¨ç‰©ï¼Œä½†åœ¨ç¹æ®–å­£èŠ‚ä¼šçŸ­æš‚ç›¸èšã€‚ç†ŠçŒ«å¦ˆå¦ˆéå¸¸ç–¼çˆ±å¹¼å´½ï¼Œåˆšå‡ºç”Ÿçš„ç†ŠçŒ«å®å®åªæœ‰çº¦100å…‹é‡ï¼Œä¼šåœ¨æ¯äº²èº«è¾¹ç”Ÿæ´»1.5-2å¹´ã€‚",
        fallbackIcon: "ğŸ¼"
    },
    { 
        name: "é•¿é¢ˆé¹¿",
        adult: "https://images.pexels.com/photos/247406/giraffe-animal-mammal-wildlife.jpg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1", 
        baby: "https://images.pexels.com/photos/247407/giraffe-baby-calf-young.jpg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1", 
        familyImg: "https://images.pexels.com/photos/247408/giraffe-family-group-herd.jpg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        knowledge: "é•¿é¢ˆé¹¿ä¼šå½¢æˆæ¾æ•£çš„ç¾¤ä½“ï¼Œå¹¼å´½å‡ºç”Ÿæ—¶å°±æœ‰çº¦1.8ç±³é«˜ã€‚é•¿é¢ˆé¹¿å¦ˆå¦ˆä¼šè½®æµç…§çœ‹å½¼æ­¤çš„å¹¼å´½ï¼Œå½¢æˆ'æ‰˜å„¿æ‰€'ç³»ç»Ÿï¼Œè®©å…¶ä»–æ¯äº²æœ‰æ—¶é—´è§…é£Ÿã€‚",
        fallbackIcon: "ğŸ¦’"
    },
    { 
        name: "åŒ—æç†Š",
        adult: "https://images.pexels.com/photos/247409/polar-bear-animal-wildlife-arctic.jpg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1", 
        baby: "https://images.pexels.com/photos/598966/polar-bear-cub-grayscale.jpg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1", 
        familyImg: "https://images.pexels.com/photos/6403048/polar-bear-family-underwater.jpg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
        knowledge: "åŒ—æç†Šæ˜¯ç‹¬å±…åŠ¨ç‰©ï¼Œä½†æ¯ç†Šä¼šä¸å¹¼å´½ä¸€èµ·ç”Ÿæ´»ã€‚å¹¼ç†Šä¼šè·Ÿéšæ¯äº²2-3å¹´ï¼Œå­¦ä¹ æ•çŒå’Œç”Ÿå­˜æŠ€èƒ½ï¼Œä¹‹åä¼šç‹¬ç«‹ç”Ÿæ´»ã€‚",
        fallbackIcon: "ğŸ»â€â„ï¸"
    }
];

        // æ¸¸æˆçŠ¶æ€å˜é‡
        let gameStarted = false;
        let timer;
        let timeLeft = 120;
        let score = 0;
        let matchedPairs = 0;
        let selectedCards = [];
        let cards = [];
        let imagesLoaded = 0;
        let totalImages = animalPairs.length * 3; // æ¯ç§åŠ¨ç‰©æœ‰3å¼ å›¾ç‰‡

        // DOMå…ƒç´ 
        const gameBoard = document.getElementById('gameBoard');
        const timerDisplay = document.getElementById('timer');
        const matchedDisplay = document.getElementById('matched');
        const scoreDisplay = document.getElementById('score');
        const startBtn = document.getElementById('startBtn');
        const resetBtn = document.getElementById('resetBtn');
        const hintBtn = document.getElementById('hintBtn');
        const message = document.getElementById('message');
        const animalFamilyImg = document.getElementById('animalFamilyImg');
        const animalFamilyTitle = document.getElementById('animalFamilyTitle');
        const animalKnowledge = document.getElementById('animalKnowledge');
        const timeProgress = document.getElementById('timeProgress');

        // é¢„åŠ è½½å›¾ç‰‡
        function preloadImages() {
            animalPairs.forEach(pair => {
                const images = [pair.adult, pair.baby, pair.familyImg];
                images.forEach(src => {
                    const img = new Image();
                    img.src = src;
                    img.onload = () => {
                        imagesLoaded++;
                        if (imagesLoaded === totalImages) {
                            initGame();
                        }
                    };
                    img.onerror = () => {
                        console.error(`Failed to load image: ${src}`);
                        imagesLoaded++;
                        if (imagesLoaded === totalImages) {
                            initGame();
                        }
                    };
                });
            });
        }

        // åˆ›å»ºå¡ç‰‡å…ƒç´ 
        function createCardElement(card, index) {
            const cardElement = document.createElement('div');
            cardElement.className = 'card';
            cardElement.dataset.index = index;
            cardElement.dataset.type = card.type;
            cardElement.dataset.pairId = card.pairId;
            
            const cardContent = document.createElement('div');
            cardContent.className = 'card-content';
            
            const animalImage = document.createElement('img');
            animalImage.className = 'animal-image';
            animalImage.src = card.value;
            animalImage.alt = card.type === 'adult' ? `${card.name} (æˆå¹´)` : `${card.name} (å¹¼å¹´)`;
            
            // æ·»åŠ å›¾ç‰‡åŠ è½½å¤±è´¥å¤„ç†
            animalImage.onerror = () => {
                const animal = animalPairs.find(p => p.name === card.name);
                animalImage.style.display = 'none';
                const placeholder = document.createElement('div');
                placeholder.className = 'image-placeholder';
                placeholder.innerHTML = `
                    <div class="fallback-icon">${animal.fallbackIcon}</div>
                `;
                cardContent.appendChild(placeholder);
            };
            
            const animalLabel = document.createElement('div');
            animalLabel.className = 'animal-label';
            animalLabel.textContent = card.type === 'adult' ? `${card.name} (æˆå¹´)` : `${card.name} (å¹¼å¹´)`;
            
            cardContent.appendChild(animalImage);
            //cardContent.appendChild(animalLabel);
            cardElement.appendChild(cardContent);
            
            cardElement.addEventListener('click', () => handleCardClick(cardElement));
            
            return cardElement;
        }

        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            // æ¸…ç©ºæ¸¸æˆæ¿
            gameBoard.innerHTML = '';
            selectedCards = [];
            cards = [];
            
            // åˆ›å»ºå¡ç‰‡æ•°ç»„
            let cardValues = [];
            animalPairs.forEach(pair => {
                cardValues.push({ type: 'adult', value: pair.adult, name: pair.name, pairId: pair.name });
                cardValues.push({ type: 'baby', value: pair.baby, name: pair.name, pairId: pair.name });
            });
            
            // éšæœºæ’åºå¡ç‰‡
            cardValues.sort(() => Math.random() - 0.5);
            
            // åˆ›å»ºå¡ç‰‡å…ƒç´ 
            cardValues.forEach((card, index) => {
                const cardElement = createCardElement(card, index);
                gameBoard.appendChild(cardElement);
                cards.push(cardElement);
            });
            
            // é‡ç½®æ¸¸æˆçŠ¶æ€
            timeLeft = 120;
            score = 0;
            matchedPairs = 0;
            updateDisplay();
            
            // é‡ç½®åŠ¨ç‰©ä¿¡æ¯æ˜¾ç¤º
            showAnimalInfo(animalPairs[0]);
        }

        // å¤„ç†å¡ç‰‡ç‚¹å‡»
        function handleCardClick(card) {
            if (!gameStarted || card.classList.contains('matched') || card.classList.contains('selected')) {
                return;
            }
            
            // æ·»åŠ é€‰ä¸­çŠ¶æ€
            card.classList.add('selected');
            selectedCards.push(card);
            
            // å¦‚æœé€‰ä¸­äº†ä¸¤å¼ å¡ç‰‡
            if (selectedCards.length === 2) {
                const card1 = selectedCards[0];
                const card2 = selectedCards[1];
                
                // æ£€æŸ¥æ˜¯å¦åŒ¹é…
                if (card1.dataset.pairId === card2.dataset.pairId && card1.dataset.type !== card2.dataset.type) {
                    // åŒ¹é…æˆåŠŸ
                    setTimeout(() => {
                        card1.classList.add('matched');
                        card2.classList.add('matched');
                        
                        // ç»˜åˆ¶è¿æ¥çº¿
                        drawConnectionLine(card1, card2);
                        
                        // æ›´æ–°åˆ†æ•°å’ŒåŒ¹é…æ•°
                        score += 100;
                        matchedPairs++;
                        updateDisplay();
                        
                        // æ˜¾ç¤ºåŠ¨ç‰©ä¿¡æ¯
                        const matchedAnimal = animalPairs.find(pair => pair.name === card1.dataset.pairId);
                        showAnimalInfo(matchedAnimal);
                        
                        // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                        showMessage(`åŒ¹é…æˆåŠŸï¼${matchedAnimal.name}å®¶åº­ +100åˆ†`);
                        
                        // æ£€æŸ¥æ¸¸æˆæ˜¯å¦ç»“æŸ
                        if (matchedPairs === animalPairs.length) {
                            endGame(true);
                        }
                        
                        selectedCards = [];
                    }, 500);
                } else {
                    // åŒ¹é…å¤±è´¥
                    setTimeout(() => {
                        card1.classList.remove('selected');
                        card2.classList.remove('selected');
                        selectedCards = [];
                        
                        // æ‰£åˆ†
                        score = Math.max(0, score - 10);
                        updateDisplay();
                        
                        // æ˜¾ç¤ºå¤±è´¥æ¶ˆæ¯
                        showMessage('ä¸åŒ¹é…ï¼Œå†è¯•ä¸€æ¬¡ï¼ -10åˆ†');
                    }, 1000);
                }
            }
        }

        // æ˜¾ç¤ºåŠ¨ç‰©ä¿¡æ¯
        function showAnimalInfo(animal) {
            const img = document.createElement('img');
            img.src = animal.familyImg;
            img.alt = `${animal.name}å®¶åº­`;
            img.onerror = () => {
                animalFamilyImg.innerHTML = `
                    <div class="image-placeholder">
                        <div class="fallback-icon">${animal.fallbackIcon}</div>
                        <span>${animal.name}å®¶åº­</span>
                    </div>
                `;
            };
            
            animalFamilyImg.innerHTML = '';
            animalFamilyImg.appendChild(img);
            animalFamilyTitle.textContent = `${animal.name}å®¶åº­`;
            animalKnowledge.textContent = animal.knowledge;
        }

        // ç»˜åˆ¶è¿æ¥çº¿
        function drawConnectionLine(card1, card2) {
            const rect1 = card1.getBoundingClientRect();
            const rect2 = card2.getBoundingClientRect();
            
            const x1 = rect1.left + rect1.width / 2;
            const y1 = rect1.top + rect1.height / 2;
            const x2 = rect2.left + rect2.width / 2;
            const y2 = rect2.top + rect2.height / 2;
            
            const length = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
            const angle = Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI;
            
            const line = document.createElement('div');
            line.className = 'connection-line';
            line.style.width = `${length}px`;
            line.style.height = '4px';
            line.style.left = `${x1}px`;
            line.style.top = `${y1}px`;
            line.style.transform = `rotate(${angle}deg)`;
            line.style.transformOrigin = '0 0';
            
            document.body.appendChild(line);
            
            // 2ç§’åç§»é™¤è¿æ¥çº¿
            setTimeout(() => {
                document.body.removeChild(line);
            }, 2000);
        }

        // æ˜¾ç¤ºæ¶ˆæ¯
        function showMessage(text) {
            message.textContent = text;
            message.style.display = 'block';
            
            setTimeout(() => {
                message.style.display = 'none';
            }, 1500);
        }

        // æ›´æ–°æ˜¾ç¤º
        function updateDisplay() {
            timerDisplay.textContent = timeLeft;
            matchedDisplay.textContent = `${matchedPairs}/${animalPairs.length}`;
            scoreDisplay.textContent = score;
            timeProgress.style.width = `${(timeLeft / 120) * 100}%`;
        }

        // å¼€å§‹æ¸¸æˆ
        function startGame() {
            if (gameStarted) return;
            
            gameStarted = true;
            startBtn.disabled = true;
            
            // å¯åŠ¨è®¡æ—¶å™¨
            timer = setInterval(() => {
                timeLeft--;
                updateDisplay();
                
                if (timeLeft <= 0) {
                    endGame(false);
                }
            }, 1000);
        }

        // ç»“æŸæ¸¸æˆ
        function endGame(isWin) {
            clearInterval(timer);
            gameStarted = false;
            startBtn.disabled = false;
            
            if (isWin) {
                score += timeLeft * 5; // å‰©ä½™æ—¶é—´å¥–åŠ±
                updateDisplay();
                showMessage(`æ­å–œä½ èµ¢äº†ï¼æœ€ç»ˆå¾—åˆ†: ${score}`);
            } else {
                showMessage('æ—¶é—´åˆ°ï¼æ¸¸æˆç»“æŸ');
            }
        }

        // æç¤ºåŠŸèƒ½
        function showHint() {
            if (!gameStarted) {
                showMessage('è¯·å…ˆå¼€å§‹æ¸¸æˆï¼');
                return;
            }
            
            // æ‰¾åˆ°ä¸€å¯¹æœªåŒ¹é…çš„å¡ç‰‡
            const unmatchedCards = cards.filter(card => !card.classList.contains('matched'));
            let hintPair = null;
            
            for (let i = 0; i < unmatchedCards.length; i++) {
                for (let j = i + 1; j < unmatchedCards.length; j++) {
                    const card1 = unmatchedCards[i];
                    const card2 = unmatchedCards[j];
                    
                    if (card1.dataset.pairId === card2.dataset.pairId && card1.dataset.type !== card2.dataset.type) {
                        hintPair = [card1, card2];
                        break;
                    }
                }
                if (hintPair) break;
            }
            
            if (hintPair) {
                // é«˜äº®æç¤ºçš„å¡ç‰‡
                hintPair[0].classList.add('selected');
                hintPair[1].classList.add('selected');
                
                // æ‰£åˆ†
                score = Math.max(0, score - 20);
                updateDisplay();
                
                setTimeout(() => {
                    hintPair[0].classList.remove('selected');
                    hintPair[1].classList.remove('selected');
                }, 1000);
                
                showMessage('æç¤ºå·²æ˜¾ç¤ºï¼ -20åˆ†');
            }
        }

        // äº‹ä»¶ç›‘å¬
        startBtn.addEventListener('click', startGame);
        resetBtn.addEventListener('click', () => {
            clearInterval(timer);
            gameStarted = false;
            startBtn.disabled = false;
            initGame();
        });
        hintBtn.addEventListener('click', showHint);

        // é¢„åŠ è½½å›¾ç‰‡å¹¶åˆå§‹åŒ–æ¸¸æˆ
        preloadImages();
    </script>
</body>
</html>